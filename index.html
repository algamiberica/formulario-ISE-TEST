<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario Harman ISE 2025</title>
    <style>
        /* Estilos similares al ejemplo anterior */
    </style>
</head>
<body>
    <div class="form-container">
        <h1>Formulario Demos Harman ISE 2025</h1>

        <table>
            <thead>
                <tr>
                    <th>Horario</th>
                    <th>Martes 4</th>
                    <th>Miércoles 5</th>
                    <th>Jueves 6</th>
                    <th>Viernes 7</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>09:00 - 09:45</td>
                    <td><button class="demo-button" data-demo="JBL 4-9:00" data-start="20250104T090000" data-end="20250104T094500">JBL Pro Audio Demo</button></td>
                    <td></td>
                    <td><button class="demo-button" data-demo="JBL 6-9:00" data-start="20250106T090000" data-end="20250106T094500">JBL Pro Audio Demo</button></td>
                    <td></td>
                </tr>
                <tr>
                    <td>15:00 - 15:45</td>
                    <td><button class="demo-button" data-demo="BSS 4-15:00" data-start="20250104T150000" data-end="20250104T154500">BSS Soundweb OMNI</button></td>
                    <td><button class="happy-button" data-demo="Happy Hour" data-start="20250105T150000" data-end="20250105T154500">Happy Hour</button></td>
                    <td><button class="demo-button" data-demo="BSS 6-15:00" data-start="20250106T150000" data-end="20250106T154500">BSS Soundweb OMNI</button></td>
                    <td></td>
                </tr>
            </tbody>
        </table>

        <form id="signupForm">
            <label for="name">Nombre:</label>
            <input type="text" id="name" name="name" required>

            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>

            <button type="submit">Enviar y Descargar Eventos</button>
        </form>
    </div>

    <script>
        // Selección de botones
        document.querySelectorAll('.demo-button, .happy-button').forEach(button => {
            button.addEventListener('click', () => {
                button.classList.toggle('selected');
            });
        });

        // Función para crear un archivo ICS
        function createICS(events) {
            let icsContent = `BEGIN:VCALENDAR
VERSION:2.0
CALSCALE:GREGORIAN
PRODID:-//Your Organization//Your App//EN`;

            events.forEach(event => {
                icsContent += `
BEGIN:VEVENT
SUMMARY:${event.title}
DTSTART:${event.start}
DTEND:${event.end}
LOCATION:${event.location}
DESCRIPTION:${event.details}
STATUS:CONFIRMED
SEQUENCE:0
END:VEVENT`;
            });

            icsContent += `
END:VCALENDAR`;

            return icsContent;
        }

        // Envío del formulario
        document.getElementById('signupForm').addEventListener('submit', function (event) {
            event.preventDefault();

            const formData = new FormData(event.target);
            const name = formData.get('name');
            const email = formData.get('email');

            const selectedEvents = Array.from(document.querySelectorAll('.demo-button.selected, .happy-button.selected')).map(button => ({
                title: button.dataset.demo,
                start: button.dataset.start,
                end: button.dataset.end,
                location: 'ISE 2025, Fira de Barcelona',
                details: `Evento seleccionado por: ${name} (${email})`
            }));

            if (selectedEvents.length === 0) {
                alert('Por favor selecciona al menos un evento.');
                return;
            }

            const icsFileContent = createICS(selectedEvents);

            // Crear archivo blob y descargarlo
            const blob = new Blob([icsFileContent], { type: 'text/calendar' });
            const url = URL.createObjectURL(blob);

            const a = document.createElement('a');
            a.href = url;
            a.download = 'eventos_ise_2025.ics';
            a.click();

            URL.revokeObjectURL(url);
        });
    </script>
</body>
</html>

